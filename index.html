<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokéAPI</title>
    <link rel="icon" href="https://pokeapi.co/pokeapi_192_square.png">
    <meta property="og:title" content="PokéAPI">
    <meta property="og:image" content="https://pokeapi.co/pokeapi_192_square.png">
    <meta property="og:description" content="Frontend HTML5, CSS3 y JavaScript que consume la API PokéAPI">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col">
                <h1 class="text-center">PokéAPI</h1>
            </div>
        </div>

        <div class="row mb-2">
            <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                <button type="button" class="btn btn-outline-primary" onclick="RetrocederPagina()"> < </button>
                <button type="button" class="btn btn-outline-primary" onclick="AdelantarPagina()"> > </button>

                <div class="btn-group" role="group">
                    <button id="btnGroupDrop1" type="button" class="btn btn-outline-primary dropdown-toggle"
                        data-bs-toggle="dropdown" aria-expanded="false">Índice</button>
                    <ul id="menu" class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                        <li><a class="dropdown-item" href="#" onclick="SetearPagina(1)">1</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row row-cols-1 row-cols-md-5 g-4" id="contenedor">

        </div>

        <div class="row mb-3 mt-2">
            <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                <button type="button" class="btn btn-outline-primary" onclick="RetrocederPagina()"> < </button>
                <button type="button" class="btn btn-outline-primary" onclick="AdelantarPagina()"> > </button>
            </div>
        </div>
    </div>

    <script>
        let pagina = 1;
        let listaPokemons = [];
        const contenedor = document.getElementById('contenedor');

        const dropdown = document.getElementById('menu');
        const ultimaPagina = 51;
        dropdown.innerHTML = '';
        for (let i = 1; i <= ultimaPagina; i++) {
            dropdown.innerHTML += '<li><a class="dropdown-item" onclick="SetearPagina(' + i + ')">' + i + '</a></li>';
        }

        function CompletarDatos() {
            contenedor.innerHTML = '<div class="col"><h2 class="text-center">Cargando...</h2></div>';
            listaPokemons = [];

            for (let index = (pagina * 20 - 19); index <= (pagina * 20); index++) {
                listaPokemons.push(fetch('https://pokeapi.co/api/v2/pokemon-form/' + index).then(response => response.json()));
            }

            Promise.allSettled(listaPokemons)
                .then(result => result.filter(x => x.status === "fulfilled"))
                .then(result => {
                    contenedor.innerHTML = ''
                    return result.map(pokemons => pokemons.value)
                })
                .then(result => result.map(pokemon => {
                    let div1 = document.createElement('div');
                    let div2 = document.createElement('div');
                    let img = document.createElement('img');
                    let div3 = document.createElement('div');
                    let p1 = document.createElement('p');
                    let p2 = document.createElement('p');
                    let p3 = document.createElement('p');

                    div1.className = 'col';
                    div2.className = 'card text-dark bg-light';
                    img.className = 'card-img-top';
                    div3.className = 'card-body';
                    p1.className = 'card-text text-center';
                    p2.className = 'card-text text-center fw-bolder';
                    p3.className = 'card-text text-center';

                    img.src = pokemon.sprites.front_default;
                    img.alt = pokemon.name;
                    p1.innerText = '#' + pokemon.id;
                    p2.innerText = pokemon.name;

                    if (pokemon.types.length > 1) {
                        switch (pokemon.types[0].type.name) {
                            case 'fighting':
                                p3.innerText = 'Tipo: lucha';
                                break;
                            case 'flying':
                                p3.innerText = 'Tipo: volador';
                                break;
                            case 'poison':
                                p3.innerText = 'Tipo: veneno';
                                break;
                            case 'ground':
                                p3.innerText = 'Tipo: tierra';
                                break;
                            case 'rock':
                                p3.innerText = 'Tipo: roca';
                                break;
                            case 'bug':
                                p3.innerText = 'Tipo: bicho';
                                break;
                            case 'ghost':
                                p3.innerText = 'Tipo: fantasma';
                                break;
                            case 'steel':
                                p3.innerText = 'Tipo: acero';
                                break;
                            case 'fire':
                                p3.innerText = 'Tipo: fuego';
                                break;
                            case 'water':
                                p3.innerText = 'Tipo: agua';
                                break;
                            case 'grass':
                                p3.innerText = 'Tipo: planta';
                                break;
                            case 'electric':
                                p3.innerText = 'Tipo: eléctrico';
                                break;
                            case 'psychic':
                                p3.innerText = 'Tipo: psíquico';
                                break;
                            case 'ice':
                                p3.innerText = 'Tipo: hielo';
                                break;
                            case 'dragon':
                                p3.innerText = 'Tipo: dragón';
                                break;
                            case 'dark':
                                p3.innerText = 'Tipo: siniestro';
                                break;
                            case 'fairy':
                                p3.innerText = 'Tipo: hada';
                                break;
                            case 'unknown':
                                p3.innerText = 'Tipo: (?)';
                                break;
                            case 'shadow':
                                p3.innerText = 'Tipo: oscuro';
                                break;
                            default:
                                p3.innerText = 'Tipo: ' + pokemon.types[0].type.name;
                                break;
                        }

                        switch (pokemon.types[1].type.name) {
                            case 'fighting':
                                p3.innerText += ' y lucha';
                                break;
                            case 'flying':
                                p3.innerText += ' y volador';
                                break;
                            case 'poison':
                                p3.innerText += ' y veneno';
                                break;
                            case 'ground':
                                p3.innerText += ' y tierra';
                                break;
                            case 'rock':
                                p3.innerText += ' y roca';
                                break;
                            case 'bug':
                                p3.innerText += ' y bicho';
                                break;
                            case 'ghost':
                                p3.innerText += ' y fantasma';
                                break;
                            case 'steel':
                                p3.innerText += ' y acero';
                                break;
                            case 'fire':
                                p3.innerText += ' y fuego';
                                break;
                            case 'water':
                                p3.innerText += ' y agua';
                                break;
                            case 'grass':
                                p3.innerText += ' y planta';
                                break;
                            case 'electric':
                                p3.innerText += ' y eléctrico';
                                break;
                            case 'psychic':
                                p3.innerText += ' y psíquico';
                                break;
                            case 'ice':
                                p3.innerText += ' y hielo';
                                break;
                            case 'dragon':
                                p3.innerText += ' y dragón';
                                break;
                            case 'dark':
                                p3.innerText += ' y siniestro';
                                break;
                            case 'fairy':
                                p3.innerText += ' y hada';
                                break;
                            case 'unknown':
                                p3.innerText += ' y (?)';
                                break;
                            case 'shadow':
                                p3.innerText += ' y oscuro';
                                break;
                            default:
                                p3.innerText += ' y ' + pokemon.types[1].type.name;
                                break;
                        }
                    }
                    else {
                        switch (pokemon.types[0].type.name) {
                            case 'fighting':
                                p3.innerText = 'Tipo: lucha';
                                break;
                            case 'flying':
                                p3.innerText = 'Tipo: volador';
                                break;
                            case 'poison':
                                p3.innerText = 'Tipo: veneno';
                                break;
                            case 'ground':
                                p3.innerText = 'Tipo: tierra';
                                break;
                            case 'rock':
                                p3.innerText = 'Tipo: roca';
                                break;
                            case 'bug':
                                p3.innerText = 'Tipo: bicho';
                                break;
                            case 'ghost':
                                p3.innerText = 'Tipo: fantasma';
                                break;
                            case 'steel':
                                p3.innerText = 'Tipo: acero';
                                break;
                            case 'fire':
                                p3.innerText = 'Tipo: fuego';
                                break;
                            case 'water':
                                p3.innerText = 'Tipo: agua';
                                break;
                            case 'grass':
                                p3.innerText = 'Tipo: planta';
                                break;
                            case 'electric':
                                p3.innerText = 'Tipo: eléctrico';
                                break;
                            case 'psychic':
                                p3.innerText = 'Tipo: psíquico';
                                break;
                            case 'ice':
                                p3.innerText = 'Tipo: hielo';
                                break;
                            case 'dragon':
                                p3.innerText = 'Tipo: dragón';
                                break;
                            case 'dark':
                                p3.innerText = 'Tipo: siniestro';
                                break;
                            case 'fairy':
                                p3.innerText = 'Tipo: hada';
                                break;
                            case 'unknown':
                                p3.innerText = 'Tipo: (?)';
                                break;
                            case 'shadow':
                                p3.innerText = 'Tipo: oscuro';
                                break;
                            default:
                                p3.innerText = 'Tipo: ' + pokemon.types[0].type.name;
                                break;
                        }
                    }

                    div3.append(p1);
                    div3.append(p2);
                    div3.append(p3);
                    div2.append(img);
                    div2.append(div3);
                    div1.append(div2);
                    contenedor.append(div1);
                }));
        }

        function SetearPagina(numero) {
            pagina = numero;
            CompletarDatos();
        }

        function RetrocederPagina() {
            if (!(pagina <= 1)) {
                pagina--;
                CompletarDatos();
            }
        }

        function AdelantarPagina() {
            if (!(pagina >= ultimaPagina)) {
                pagina++;
                CompletarDatos();
            }
        }

        CompletarDatos();
    </script>

</body>

</html>